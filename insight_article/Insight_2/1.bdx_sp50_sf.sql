
select last_day(
  
  
case 

when BDX_ANNUAL_REPORT_DATE = 'Current' then CURRENT_DATE()
else date(replace(concat('1 ', BDX_ANNUAL_REPORT_DATE), ' ', '-'))

end
  
) as datetime, a.*, f.FF_ROA, f.FF_ROE, f.FF_ROTC
from "FDS"."BDX_V1"."BDX_BOARD_CHAR" a 
join "FDS"."BDX_V1"."BDX_COMPANY_STOCKS" b on a.bdx_company_id = b.bdx_company_id
join "FDS"."BDX_V1"."BDX_FACTSET_ID_MAP" c on c.provider_id = b.bdx_security_id
join "FDS"."SYM_V1"."SYM_COVERAGE" d on c.factset_id = d.fsym_security_id
join "FDS"."FF_V3"."FF_ADVANCED_AF" e on d.fsym_id = e.fsym_id and datetime = e.date
join "FDS"."FF_V3"."FF_BASIC_DER_AF" f on e.fsym_id = f.fsym_id and f.date = e.date
join "FDS"."FF_V3"."FF_ADVANCED_DER_AF" g on f.fsym_id = g.fsym_id and f.date = g.date

where a.bdx_nationality_mix <> 0 and a.bdx_gender_ratio <> 100 and a.bdx_board_char_type = 'Overall Board Characteristics' and d.fsym_id in 



(
'F07Q7W-R',
'MKC1SV-R',
'RFPMVX-R',
'JWH12W-R',
'LY653H-R',
'FS32CR-R',
'CN7T72-R',
'X0N4MP-R',
'V9977J-R',
'KC6WDM-R',
'XMYTFJ-R',
'DH7WLK-R',
'SDDH43-R',
'JXMLY8-R',
'RDKCLT-R',
'GRMY8C-R',
'F17SJ1-R',
'VR16P9-R',
'HXZ458-R',
'MG2TQV-R',
'RQXL78-R',
'B3DVXC-R',
'KDHCQP-R',
'SHNVG7-R',
'XGFDHN-R',
'MYW502-R',
'KW432H-R',
'C8WF4C-R',
'P8R3C2-R',
'PN37ZK-R',
'F1DFCD-R',
'K38HHD-R',
'TMTGLT-R',
'GZF20K-R',
'V6ZQWF-R',
'GGPVTB-R',
'MDYC2K-R',
'NNKD2Y-R',
'FPPSQ1-R',
'NYN4GC-R',
'RRXTTL-R',
'CYB6Y5-R',
'MQ0Y3T-R',
'S8Z499-R',
'J2MW73-R',
'NW8BQ3-R',
'TWTDGH-R',
'WGLQTS-R',
'K8YRNT-R',
'QWV5DL-R',
'K24537-R',
'TVTFDF-R',
'GN6KCJ-R',
'CJVKH9-R',
'LRK013-R',
'NNFR4J-R',
'FYT41X-R',
'LBWNRX-R',
'QLRPKF-R',
'KYCY91-R',
'DTKZ1Y-R',
'M79B89-R',
'V2H5QG-R',
'K24Q4R-R',
'G8WDMZ-R',
'VS59M7-R',
'NT37R4-R',
'B83YJG-R',
'VFY8ZQ-R',
'B19ST9-R',
'LN3P8B-R',
'MR0PSP-R',
'NYJHHY-R',
'CGGG4R-R',
'M7439D-R',
'BL5KVX-R',
'CY644B-R',
'BYJYYM-R',
'BWDZ2P-R',
'QLQKDC-R',
'VDPDV7-R',
'VXKKH3-R',
'C7M7DL-R',
'S8ZPBT-R',
'L8SKLT-R',
'WL1GCY-R',
'VWF970-R',
'DTKPJP-R',
'MJCGG4-R',
'BCD4JF-R',
'NB76FG-R',
'LKPWM4-R',
'LD0WYZ-R',
'S8ZQDV-R',
'T6CPQP-R',
'KK1SFD-R',
'HVV49B-R',
'DDZB0B-R',
'KV0J41-R',
'N3CXK7-R',
'HMVVTC-R',
'LTP334-R',
'D0LDT1-R',
'QSDQCP-R',
'FQZF97-R',
'RK8Z6D-R',
'FXH4XG-R',
'MH7TCM-R',
'BV8JHF-R',
'MVKZ35-R',
'TKKPJB-R',
'GZKHGQ-R',
'RGZN5G-R',
'G4GB6B-R',
'DXVDJ4-R',
'FT8FQW-R',
'WQK5W2-R',
'NGW97P-R',
'FT8DNV-R',
'WPFS7S-R',
'F82H8Q-R',
'MS9FKZ-R',
'T2TNWF-R',
'WYJT0C-R',
'LX2WRB-R',
'BRWKF0-R',
'PVWPB1-R',
'KFJFWS-R',
'RPTY1P-R',
'RPNJRM-R',
'QMQV1Q-R',
'PKY50L-R',
'GN6RRQ-R',
'M0C1P8-R',
'GRSDSK-R',
'SZJL5M-R',
'WRVHRX-R',
'XKT8J2-R',
'FT7VMB-R',
'FPTJVK-R',
'TY202Q-R',
'HF5SX1-R',
'FJ1B1C-R',
'MTGSY3-R',
'FDS1XB-R',
'B6ZXQL-R',
'BM9QXX-R',
'MBK7R0-R',
'D3VZJC-R',
'JYWMBW-R',
'F1DNTM-R',
'TBS2VP-R',
'RJ022Y-R',
'X59HZ5-R',
'FH1NKL-R',
'W0Z4W6-R',
'DMRWLY-R',
'PX1NYT-R',
'SJY281-R',
'GX5LJC-R',
'V75BKP-R',
'W6N4JC-R',
'VCNXSP-R',
'CYB1M0-R',
'RZXDWV-R',
'FJ4NDH-R',
'CTYNJ1-R',
'H7DGWR-R',
'KDCD3Y-R',
'KM5Q58-R',
'CHK9QJ-R',
'KB2QBM-R',
'RXG6KB-R',
'HNZVK6-R',
'HQ87P5-R',
'SJS2RC-R',
'MCNYYL-R',
'P31DB7-R',
'JLJ0VZ-R',
'RXHN9P-R',
'T7H5H1-R',
'H1PMLS-R',
'B6V0BZ-R',
'X9Q3HC-R',
'DRBC9M-R',
'C5GXYC-R',
'DXW84Y-R',
'B6ZP8C-R',
'QG1HR7-R',
'J06Y9S-R',
'PHPSQH-R',
'HJG212-R',
'KZKK3D-R',
'KDJL0T-R',
'G7VZQH-R',
'XHD46K-R',
'LTSNXH-R',
'HSF35X-R',
'NT38T5-R',
'P36M94-R',
'BJ2HRV-R',
'PY5NPN-R',
'K7TPSX-R',
'KYJFW8-R',
'CZBYFY-R',
'D502G9-R',
'VBK29Z-R',
'R5XGXL-R',
'BK6JKQ-R',
'TZ2TSL-R',
'DJC2TN-R',
'X8L2PH-R',
'X8LB4Q-R',
'NXHLP0-R',
'NV79M1-R',
'H2VPCM-R',
'LHKN8Z-R',
'QJ9QP4-R',
'KMBRT0-R',
'RT66YK-R',
'J70ZTV-R',
'GFJGD5-R',
'J70N5J-R',
'C4C0BL-R',
'PY50G1-R',
'VNRDMV-R',
'R998SY-R',
'PVW48J-R',
'V5WMVF-R',
'CHR1NX-R',
'PRGQ6L-R',
'X1SCTR-R',
'XF43NV-R',
'LTP0Z2-R',
'JDQ0K1-R',
'B97MP0-R',
'RYRC40-R',
'J994MP-R',
'HN195G-R',
'TY1WWM-R',
'B4PGFJ-R',
'DJC60R-R',
'KHX8Q2-R',
'VDT85V-R',
'QJBZ19-R',
'MH33D6-R',
'J89J6Y-R',
'GC9695-R',
'W6SXMV-R',
'VNMTTH-R',
'DLSMXK-R',
'PTRY1F-R',
'MVLTQZ-R',
'BFSY5M-R',
'RT2ZSJ-R',
'S7P87W-R',
'WM5BXP-R',
'LD13C5-R',
'CPCV0Y-R',
'RK3HS8-R',
'HP58X9-R',
'FJ4J4C-R',
'KDJSF0-R',
'KK1YRK-R',
'NZMV05-R',
'MPXJMM-R',
'VVFNT8-R',
'DG27Q5-R',
'FWHC5K-R',
'KFMMZS-R',
'BK2FRW-R',
'XLT03X-R',
'KPFMHW-R',
'C46DK8-R',
'R2J99W-R',
'RT7HCR-R',
'BYNP13-R',
'FV824M-R',
'SHRZF5-R',
'THB4X2-R',
'W8YRN3-R',
'DH79H0-R',
'W00MKH-R',
'RJ0FT9-R',
'WFLMHL-R',
'D8D820-R',
'DXZQS6-R',
'JJ39BV-R',
'NFMPMG-R',
'HZ6Z7Q-R',
'BZPFLX-R',
'M1H0C2-R',
'CSMTMQ-R',
'VFT0VQ-R',
'GFJC62-R',
'CYBC69-R',
'Q3VTNZ-R',
'TNZ1G6-R',
'WPKF66-R',
'XLV24X-R',
'DMX4QY-R',
'SHNDLT-R',
'GQGQ5C-R',
'BQWWY7-R',
'VK7M4R-R',
'HQ4DBK-R',
'NPK7YX-R',
'CRP3ZV-R',
'NBCKRK-R',
'BV4P4T-R',
'PPCTFP-R',
'HKLJPC-R',
'PY5KHK-R',
'CPCW2Z-R',
'VTBLV9-R',
'JQZ00G-R',
'LTN366-R',
'BQR5YT-R',
'PD98GG-R',
'X1RJ5Y-R',
'FZRL7K-R',
'CHKL7S-R',
'R4M2WP-R',
'SQFMK3-R',
'L6CPTK-R',
'M1FW60-R',
'KB791X-R',
'N4P9L4-R',
'XLY63V-R',
'NPJW7K-R',
'LVYTWF-R',
'JPTF52-R',
'FBCHQC-R',
'GRS9LG-R',
'NW728X-R',
'JTC04X-R',
'DJBQ39-R',
'MQ119X-R',
'LC0H1H-R',
'QHBXV5-R',
'PZ917X-R',
'LX237L-R',
'FBB432-R',
'HSFL3C-R',
'JCPT0R-R',
'LJQYJ1-R',
'JKDM7P-R',
'M0H6M5-R',
'FFQNC3-R',
'HF1P15-R',
'RK3DL5-R',
'D68983-R',
'TWXW2R-R',
'NV7K28-R',
'FQYW7Q-R',
'NPK3PS-R',
'FR4YZK-R',
'GM3DBL-R',
'MKJ8WW-R',
'LQBB5R-R',
'BWZ93Y-R',
'KFQHFG-R',
'BNJBN6-R',
'G3949H-R',
'HTM0LK-R',
'VZYGFG-R',
'RJVBBR-R',
'PN6Y00-R',
'N2GNNQ-R',
'Q8G78M-R',
'XC2LNC-R',
'RBJXH6-R',
'XM8P7T-R',
'CSFJSZ-R',
'C8XJ7D-R',
'S4J8BX-R',
'DBNXVB-R',
'T0SQZH-R',
'QCYLZB-R',
'GYM5PB-R',
'C4HBRT-R',
'L7LP86-R',
'VBCQMG-R',
'TNZ6CZ-R',
'V3Q5PM-R',
'DF9PT2-R',
'BPRHF0-R',
'FVD6P4-R',
'T67DJN-R',
'XKBMRH-R',
'WGXV7D-R',
'RVC5J9-R',
'KB3YPS-R',
'NFMH78-R',
'WFMVVR-R',
'PVBYXV-R',
'RTXD8D-R',
'FJ8GT6-R',
'JFW5HZ-R',
'CFG1CD-R',
'F05QG0-R',
'HHB3C8-R',
'Q78D01-R',
'NKGZ7J-R',
'J1JDGR-R',
'KXDMGL-R',
'TXN5MP-R',
'QP3LLV-R',
'BYP0PF-R',
'JMNLQC-R',
'M79R1P-R',
'C0YGQ6-R',
'PJNB5B-R',
'GZMRSV-R',
'VT4SWZ-R',
'S26JJL-R',
'M67VFY-R',
'VT66G5-R',
'B81TLL-R',
'MLQ41B-R',
'FS319Q-R',
'Q2YN1N-R',
'XKPH9J-R',
'CQY5QT-R',
'WFJYTJ-R',
'BDQDB8-R',
'T3YH93-R',
'MFQVZQ-R',
'GGPDYX-R',
'F1B8CH-R',
'FDS65G-R',
'SKZRLQ-R',
'RGTY61-R',
'CL1QH9-R',
'FMDS8D-R',
'QKJS7V-R',
'W0731Q-R',
'GS3RJ8-R',
'VLHKF9-R',
'W8Y3WZ-R',
'XD67LR-R',
'W5QQ9P-R',
'JZWRR3-R',
'TTHJD1-R',
'VBN9H0-R',
'NCL5GV-R',
'PTMMVD-R',
'GRQMJ0-R',
'F9VYPD-R',
'KRQTDT-R',
'SNC4KL-R',
'D1P43P-R',
'VR4SHN-R',
'V2PDWL-R',
'KFP2R4-R',
'DGBZCC-R',
'FQJDL3-R',
'TW6KKV-R',
'MXZ7RW-R',
'KTPK4Q-R',
'JKGP5M-R',
'LC1BTF-R',
'HP13ZD-R',
'MS57L1-R',
'CRHPMR-R',
'JMHYW0-R',
'S9NVWV-R',
'MMRZQ5-R',
'T1N9NF-R',
'HJXXH4-R',
'VQYTRP-R',
'QLGSL2-R',
'VWGLQ7-R',
'JRFYNM-R',
'FXTG1M-R',
'RSQN90-R',
'FCK6QT-R',
'H69CWS-R',
'WDG05S-R',
'TTDQ0D-R',
'MJ0XB7-R',
'SPGL7X-R',
'M8867B-R',
'B8ZY81-R',
'RQ9F5S-R',
'Q4YP8S-R',
'P1P032-R',
'L32LM8-R',
'MZJHY9-R',
'KTBGHT-R',
'WF15WW-R',
'C7C9TP-R',
'LQ766T-R',
'M8XT6B-R',
'LPRN3T-R',
'NHV4Q7-R',
'VQXR21-R',
'HQ2MHF-R',
'LZBPWV-R',
'K6RW63-R',
'RYTJNF-R',
'RCNCKX-R',
'HY8GBD-R',
'B71DJZ-R'
)


